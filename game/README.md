# AI Route Battle

JR山手線大崎駅からアートヴィレッジ大崎セントラルタワー5階のFindyオフィスまでのルートについて、AIモデルの出力結果で対戦するゲームアプリケーションです。

## 機能

- **AIモデル選択**: ChatGPT-4、Claude-3.5-Sonnet、Gemini Pro等の主要AIモデルから選択
- **ルート入力**: AIが出力したルート情報を貼り付けて投稿
- **リアルタイム対戦**: Socket.IOを使用したリアルタイムマッチメイキング
- **自動判定**: パターンマッチングによる高速で正確な評価システム
- **AIモデル倍率**: プレミアムモデルほど低い倍率でペナルティを適用
- **ダークテーマ**: サイバーパンク風のスタイリッシュなUI

## 技術スタック

### フロントエンド
- React 18
- Vite (開発サーバー)
- Material-UI (MUI) - モダンなUI/UXデザイン
- Socket.io-client - リアルタイム通信

### バックエンド
- Node.js
- Express.js
- Socket.io - WebSocketサーバー
- パターンマッチング評価システム
- CORS対応

## プロジェクト構成

```
game/
├── frontend/          # Reactフロントエンド
│   ├── src/
│   │   ├── components/    # UIコンポーネント
│   │   │   ├── GameSetup.jsx      # ゲーム設定画面
│   │   │   ├── WaitingScreen.jsx  # 待機画面
│   │   │   ├── JudgingScreen.jsx  # 判定画面（ロード表示）
│   │   │   ├── PlayerCard.jsx     # プレイヤーカード
│   │   │   ├── GameResult.jsx     # 結果表示
│   │   │   └── EvaluationDetails.jsx # 評価詳細表示
│   │   ├── hooks/         # カスタムフック
│   │   │   └── useSocket.js       # Socket.io管理
│   │   └── App.jsx        # メインアプリケーション
│   └── package.json
└── backend/           # Node.jsバックエンド
    ├── server.js      # サーバーメイン
    ├── answerData.js  # 評価ロジック（パターンマッチング）
    └── package.json
```

## セットアップ手順

### 1. 依存関係のインストール

**バックエンド:**
```bash
cd backend
npm install
```

**フロントエンド:**
```bash
cd frontend
npm install
```

### 2. サーバー起動

**バックエンドサーバー (ポート3001):**
```bash
cd backend
npm start
```

**フロントエンドサーバー (ポート5173):**
```bash
cd frontend
npm run dev
```

### 3. アクセス

ブラウザで `http://localhost:5173` にアクセスしてゲームを開始してください。

## ゲームの流れ

1. **セットアップ**: AIモデルを選択し、ルート案内の出力を入力
2. **マッチメイキング**: 他のプレイヤーとの対戦相手を検索
3. **バトル**: 両プレイヤーの出力を表示し、評価を確認
4. **判定**: パターンマッチングによる自動評価（2秒間）
5. **結果**: 勝敗とスコアを表示

## 対象ルート

**出発地点**: JR山手線 大崎駅
**目的地**: アートヴィレッジ大崎セントラルタワー 5階 Findyオフィス

最適なルートは徒歩約5分、距離約600mとなります。

## 評価システム

### 評価カテゴリー（100点満点）

- **基本情報** (20点): ビル名とフロア情報
- **ルートの正確性** (40点): 重要なキーワードの存在
- **時間の正確性** (15点): 所要時間の記載
- **詳細情報** (25点): 追加の有用な情報

### AIモデル倍率

| モデル | 倍率 | 説明 |
|--------|------|------|
| OpenAI 4o | 0.8 | プレミアムモデル |
| OpenAI o3 | 0.6 | 高性能モデル |
| OpenAI o3-pro | 0.5 | 最高性能モデル |
| Claude Sonnet 4 | 0.7 | 高性能モデル |
| Claude Opus 4 | 0.5 | 最高性能モデル |
| その他 | 1.0 | 標準倍率 |

## 開発者向け情報

### Socket.IOイベント

- `findMatch`: マッチング開始
- `waitingForMatch`: 対戦相手待ち
- `gameFound`: 対戦相手決定
- `gameResult`: ゲーム結果（自動判定後）
- `opponentDisconnected`: 相手の切断通知

### コンポーネント設計

- **関心の分離**: UI、ロジック、通信の責務を明確に分離
- **再利用性**: 汎用的なコンポーネント設計
- **状態管理**: カスタムフックによる状態の一元管理

### スタイリング

- Material-UIによる統一されたデザインシステム
- レスポンシブデザイン対応（モバイル、タブレット、デスクトップ）
- ダークテーマとサイバーパンク風のスタイル

### 技術的な実装詳細

#### パターンマッチング評価
AIによる評価から高速なパターンマッチングに変更。重要なキーワードの存在と時間情報の正確性を基準に評価を行う。

#### React Hooks対応
useSocketフックでSocket.ioの状態管理を行い、依存関係の問題を回避するため一時的にwindow.playerInputDataを使用。

#### トラブルシューティング

**ポート使用中エラー:**
```bash
lsof -ti :3001 | xargs kill -9  # バックエンド
lsof -ti :5173 | xargs kill -9  # フロントエンド
```

**Socket.io接続エラー:**
- バックエンドサーバーが起動していることを確認
- CORSの設定を確認（localhost:5173許可済み）

## 今後の拡張可能性

- ユーザー認証機能
- 戦績・ランキング機能
- 複数人対戦機能
- より高度なAI評価システム
- ルート可視化機能（地図連携）
- リプレイ機能

## ライセンス

このプロジェクトはFindyの内部プロジェクトです。